<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monkey Disco Party</title>
    
    <link rel="icon" href="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQXGGhplYWYGDElfBCfKxkU90hqV6TRdGSnhQ&s">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            font-family: 'Poppins', sans-serif;
            transition: background-color 0.1s ease; /* Very fast transition for beat sync */
            background-color: #f0f2f5; 
            overflow: hidden;
        }

        .main-card {
            background: rgba(255, 255, 255, 0.9);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            text-align: center;
            max-width: 450px;
            width: 90%;
        }

        h1 {
            color: #2c3e50;
            margin-top: 0;
            font-weight: 600;
            letter-spacing: -0.5px;
        }

        .character-container {
            height: 250px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
        }

        #dancer-img {
            max-height: 100%;
            max-width: 100%;
            border-radius: 10px; 
            transition: transform 0.1s; 
        }

        .dance-move {
            transform: scale(1.1) rotate(3deg);
        }

        .controls-area {
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
            margin-top: 20px;
        }

        .btn-group {
            display: flex;
            gap: 12px;
            justify-content: center;
            width: 100%;
        }

        button {
            padding: 12px 24px;
            font-size: 0.95rem;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        button:hover { opacity: 0.9; transform: translateY(-2px); }
        button:active { transform: scale(0.98); }

        #start { background-color: #10b981; color: white; flex: 1;} 
        #stop { background-color: #ef4444; color: white; flex: 1;} 
        .speed-btn { background-color: #e5e7eb; color: #374151; flex: 1; }

        #speed-display {
            font-size: 0.85rem;
            color: #6b7280;
            font-weight: 400;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
    </style>
</head>
<body>

    <div class="main-card">
        <h1>Disco Monkey!</h1>
        <div class="character-container">
            <img id="dancer-img" src="" alt="Dancing Monkey">
        </div>

        <div class="controls-area">
            <div id="speed-display">Speed: 1000ms</div>
            <div class="btn-group">
                <button id="start">Start Party</button>
                <button id="stop">Stop</button>
            </div>
            <div class="btn-group">
                <button id="slower" class="speed-btn">Slower</button>
                <button id="faster" class="speed-btn">Faster</button>
            </div>
        </div>
    </div>

    <script>
        // ================= IMAGES =================
        const pose1_URL = "https://media.istockphoto.com/id/1331362797/vector/cute-baby-monkey-cartoon-dabbing.jpg?s=612x612&w=0&k=20&c=ZUK19GUPGPlnpZSMMnW1PYz2cPM8k2fS1hqgENiTiyg=";
        const pose2_URL = "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTx9UxWyyAZ1FL370M2YTwDdE3BDlp5WMkXtA&s";

        // ================= NEW LOUD AUDIO SYNTHESIZER =================
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        // Master Volume (Gain) - Cranked up to 1.0 (Max safe volume)
        const masterGain = audioCtx.createGain();
        masterGain.gain.value = 0.8; 
        masterGain.connect(audioCtx.destination);

        // Function to create a generic oscillator sound
        function playTone(freqStart, freqEnd, type, duration) {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(masterGain);

            osc.type = type; // 'sine', 'square', 'sawtooth', 'triangle'
            
            const now = audioCtx.currentTime;
            
            // Pitch Envelope
            osc.frequency.setValueAtTime(freqStart, now);
            osc.frequency.exponentialRampToValueAtTime(freqEnd, now + duration);

            // Volume Envelope (Click removal)
            gain.gain.setValueAtTime(1, now);
            gain.gain.exponentialRampToValueAtTime(0.01, now + duration);

            osc.start(now);
            osc.stop(now + duration);
        }

        // --- THE 7 SOUNDS ---
        const sounds = [
            () => playTone(150, 0.01, 'sine', 0.5),      // 1. Heavy Kick
            () => playTone(600, 100, 'triangle', 0.1),   // 2. Snare-ish
            () => playTone(1000, 1000, 'square', 0.05),  // 3. Hi-Hat (Click)
            () => playTone(200, 50, 'sine', 0.3),        // 4. Tom Drum
            () => playTone(800, 200, 'sawtooth', 0.2),   // 5. Laser Zap
            () => playTone(300, 300, 'square', 0.1),     // 6. 8-Bit Blip
            () => playTone(50, 150, 'sawtooth', 0.4)     // 7. Bass Growl
        ];

        function playRandomSound() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            // Pick a random number between 0 and 6
            const randomIndex = Math.floor(Math.random() * sounds.length);
            sounds[randomIndex]();
        }
        // =============================================================

        let colorIntervalId; 
        let currentSpeed = 1000;
        let isPoseOneActive = true; 

        const dancerImg = document.getElementById('dancer-img');
        const speedDisplay = document.getElementById('speed-display');
        
        dancerImg.src = pose1_URL;

        const doTheDisco = function() {
            // 1. Play Random Sound
            playRandomSound();

            // 2. Generate Random Color
            const randomColor = '#' + Math.floor(Math.random()*16777215).toString(16).padEnd(6, '0');
            document.body.style.backgroundColor = randomColor;

            // 3. Switch Pose
            if (isPoseOneActive) {
                dancerImg.src = pose2_URL; 
            } else {
                dancerImg.src = pose1_URL; 
            }
            isPoseOneActive = !isPoseOneActive;

            // 4. Pop Animation
            dancerImg.classList.remove('dance-move');
            void dancerImg.offsetWidth; 
            dancerImg.classList.add('dance-move');
        }
        
        const startInterval = function() {
            if (audioCtx.state === 'suspended') audioCtx.resume();

            if (!colorIntervalId) {
                doTheDisco(); 
                colorIntervalId = setInterval(doTheDisco, currentSpeed);
            }
        }

        const resetInterval = function() {
            if (colorIntervalId) {
                clearInterval(colorIntervalId);
                colorIntervalId = null;
                startInterval();
            }
            speedDisplay.innerText = `Speed: ${currentSpeed}ms`;
        }

        // Listeners
        document.getElementById('start').addEventListener('click', startInterval);

        document.getElementById('stop').addEventListener('click', function(){
            clearInterval(colorIntervalId);
            colorIntervalId = null;
        });

        document.getElementById('faster').addEventListener('click', function(){
            if (currentSpeed >= 200) { 
                currentSpeed -= 100;
                resetInterval();
            }
        });

        document.getElementById('slower').addEventListener('click', function(){
             currentSpeed += 100;
             resetInterval();
        });

    </script>
</body>
</html>